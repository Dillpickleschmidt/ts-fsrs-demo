generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
  relationMode = "prisma" //emulate relations
}

model Revlog {
  lid            String   @id @unique @default(cuid())
  cid            String
  card           Card     @relation(fields: [cid], references: [cid])
  grade          Rating
  state          State
  elapsed_days   Int
  scheduled_days Int
  review         DateTime

  @@index([cid])
}

model Card {
  cid            String    @id @unique @default(cuid())
  due            DateTime  @default(now())
  stability      Float
  difficulty     Float
  elapsed_days   Int
  scheduled_days Int
  reps           Int
  lapses         Int
  state          State     @default(New)
  last_review    DateTime?
  nid            String    @unique
  note           Note      @relation(fields: [nid], references: [nid])
  logs           Revlog[]
}

model Parameters {
  uid               Int     @id @unique @default(autoincrement())
  request_retention Float   @default(0.9)
  maximum_interval  Int     @default(36500)
  w                 Json
  enable_fuzz       Boolean @default(false)
}

model Note {
  nid      String @id @unique @default(cuid())
  question String @default("")
  answer   String @default("")
  extend   Json
  card     Card?
}

enum State {
  New        @map("0")
  Learning   @map("1")
  Review     @map("2")
  Relearning @map("3")
}

enum Rating {
  Again @map("1")
  Hard  @map("2")
  Good  @map("3")
  Easy  @map("4")
}
