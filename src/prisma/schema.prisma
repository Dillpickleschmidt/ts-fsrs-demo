// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum State {
  New        @map("0")
  Learning   @map("1")
  Review     @map("2")
  Relearning @map("3")
}

enum Rating {
  Again @map("1")
  Hard  @map("2")
  Good  @map("3")
  Easy  @map("4")
}

model Revlog {
  lid            String   @id @unique @default(cuid())
  cid            String
  grade          Rating
  state          State
  elapsed_days   Int
  scheduled_days Int
  review         DateTime
  card           Card     @relation(fields: [cid], references: [cid])
}

model Card {
  cid            String    @id @unique @default(cuid())
  due            DateTime  @default(now())
  stability      Float
  difficulty     Float
  elapsed_days   Int
  scheduled_days Int
  reps           Int
  lapses         Int
  state          State     @default(New)
  last_review    DateTime?
  nid            String?   @unique
  note           Note?     @relation(fields: [nid], references: [nid])
  log            Revlog[]
}

model Parameters {
  uid               Int     @id @unique @default(autoincrement())
  request_retention Decimal @default(0.9)
  maximum_interval  Int     @default(36500)
  w                 Json    @default("[1,1,5,-0.5,-0.5,0.2,1.4,-0.12,0.8,2,-0.2,0.2,1]")
  enable_fuzz       Boolean @default(false)
}

model Note {
  nid      String @id @unique @default(cuid())
  question String @default("")
  answer   String @default("")
  card     Card?
}
